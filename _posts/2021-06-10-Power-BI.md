---
layout: post
title: Power BI Construction Analysis
image: "/posts/bi_image.jpg"
tags: [Power BI, KPIs]
---

# Description

Commodore Builders recently began transitioning to a more data-driven approach to project management. I have taken the initiative to learn Power BI and assist the internal operations team with creating dashboards and KPIs. These visualizations assist in processes including project-level safety/quality reviews, client-requested COVID compliance tracking, and senior executive KPI progress tracking.

---

# Projects

## Individual Checklist Data Aggregation

As part of our QA/QC and safety programs, employees used Procore to fill out different inspections via Procore software. Each inspection included a variety of questions that the team would need to fill out to track things like project progress, subcontractor onboarding, safety/quality status.

After gaining access to this data via connection to Power BI, the company wanted to extract information from these inspections to proactively track project status and goals. Senior leadership would use this data to improve project compliance and performance.

A key way to enable this type of tracking was to view the data from each inspection efficiently. An obstacle to doing so was the initial data structure for each inspection. The team wanted to view each inspection as one row, but in raw form each individual question was listed as its own record. For example, if an inspection had four questions, the corresponding data table would look similar to the below:

|ChecklistID|ProjectID|Position|Question|Response|
|---|---|---|---|---|
|1|100|1|First_Name|Allan|
|1|100|2|Last_Name|Khariton|
|1|100|3|Role|APM|
|1|100|4|Company|Commodore|
|2|300|1|First_Name|Jane|
|2|300|2|Last_Name|Doe|
|2|300|3|Role|SPM|
|2|300|4|Company|Commodore|

With the above structure, it would not be possible to clearly view the results from numerous inspections quickly. I was tasked with determining whether or not each inspection could be collapsed into one row for efficient viewing and aggregation purposes.

When investigating Power BI's native capabilities, I could not find a function or built-in method to perform this type of aggregation/filtering, and a consultant similarly could not find an "easy" solution for this problem.

Upon further investigation, I found a solution via the Power BI community forums <a href="https://community.powerbi.com/t5/Desktop/How-to-group-and-pivot-records-exclude-nulls/m-p/710301">here<a/>.
After reading this solution, I sorted through the posted code and extracted the portion I needed. To solve the problem, I then:
- Duplicated the original table
- Filtered columns out of the duplicate table to include only relevant columns
- Pivoted the table, so that the Question was the pivoted column and the response column was the response field for the pivot

This yielded a table that looked like the below:

|ChecklistID|ProjectID|First_Name|Last_Name|Role|Company|
|---|---|---|---|---|---|
|1|100|Allan|...|...|...|
|1|100|...|Khariton|...|...|
|1|100|...|...|APM|...|
|1|100|...|...|...|Commodore|
|2|300|Jane|...|...|...|
|2|300|...|Doe|...|...|
|2|300|...|...|SPM|...|
|2|300|...|...|...|Commodore|
Now my data was in the same position as the code in the community response, so I utilized the custom groupby syntax to collapse the above data into one row. For the sample data above, the query would look like the below and yield the following table:

``` python 

New Table = Table.Group(#"Previous_Table", ("ChecklistID"), 
    (("First_Name", each List.First(List.RemoveNulls([First_Name]))),
    ("Last_Name", each List.First(List.RemoveNulls([Last_Name]))),
    ("Role", each List.First(List.RemoveNulls([Role]))),
    ("Company", each List.First(List.RemoveNulls([Company]))))
```
|ChecklistID|ProjectID|First_Name|Last_Name|Role|Company|
|---|---|---|---|---|---|
|1|100|Allan|Khariton|APM|Commodore|
|2|300|Jane|Doe|SPM|Commodore|

With this data structure, the team could now view individual checklist records efficiently and better create measures and KPIs based on responses to checklist questions.
    
Below are a few examples of how this checklist data aggregation process has been used.
  
### Vaccination Dashboard
  
Several of Commodore's clients required that all workers on site be vaccinated. To do this, workers on site filled out an inspection verifying their vaccination status. To have quick access to this data, I used the vaccination questionnare data to create a searchable table so team members could determine whether a given worker was vaccinated. This led to a 50% reduction in time to check-in and verify status of workers.

### Subcontractor Kickoff Tracking
  
Before a new subcontractor begins work, Commodore requires them to have a kickoff meeting with the project team and fill out a corresponding inspection summary of the meeting. The teams discuss many items including financial logistics, safety plans, scope of work and start date. It is critical that these meetings take place at least 2 weeks prior to the subcontractor start date, so everyone has the same expectations for the work to be completed. To this end, I created a dashboard to track:
- The status of all kickoff meetings, including all planned meetings
- Measures showing how many total meetings were done on time, late, or were pending completion
- A % score showing how many meetings have been complete on time

With the above dashboard, our QA/QC team can now efficiently track compliance on QA/QC program requirements and inquire more specifically about work to be completed. 

<!-- ### QAQC manager score -->

---

### Subcontractor Evaluation Dashboard

When going through the procurement process, the Commodore pre-construction team wants to use data from previous projects to help determine which subcontractors to award future work to.

As part of this effort, I was tasked with created a subcontractor performance dashboard so that key on site measures could be viewed and bidder scores compared.
    
This dashboard had several visuals, including:
- Horizontal bar plot showing the number of toolbox talks done per week. A contractor must perform one per project per week
- Horizontal bar plot showing how quickly a contractor responds to observations. Observations often represent issues, so timely responses and closure of issues can be critical to project QA/QC performance
- Horizontal bar plot categorizing the types of observations assigned to a subcontractor. The team would note how many positive and negative observations a contractor has as an indication of whether work is performed safely and with minimal defect/re-work rate.
- Vertical bar chart showing the number of SPAs done per conractor. SPAs are a summary of a trade's planned work for the day. This document must be filled out daily and is used as a record in case any safety issues arise.
- Horizontal bar plot showing PPE score. Trades must abide by Commodore's PPE policy, and the Commodore team rates contractors weekly on their compliance. Higher scores indicate better compliance to standards, which leads to a safer work place and fewer injuries.

With the above dashboard created, our pre-construction team could now compare contractor safety and performance data apples-to-apples within minutes rather than trying to guess or sort through data from multiple sources for days. This will help the team make informed award decisions based on real-time data, and hopefully lead to safer job sites overall as safety and performance metrics are better incorporated in the process.


#### toolbox talk, observation responsiveness, observation #/type, SPA completed overall and weekly, PPE scores


---
### KPIs

#### Project Fee Tracking, Projects ahead of schedule (and %; by finish variance on status), total mitigation (change in finish variance after schedulle update)

---

### Quality and Safety Review Metrics

---

### OSHA Incident Rate Tracking

---

### Project Level Data Aggregation

#### QA/QC kickoffs, Safety and Risk Meetings, weekly apm/super/safety manager inspections

---

### Project team safety insepctions

#### inspections by week, by team member, weekly SPA fix, toolbox talks
